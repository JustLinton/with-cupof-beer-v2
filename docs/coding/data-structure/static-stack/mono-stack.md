# 单调栈

!!! beer-tips "浅记" 
    单调栈常用于给定一个序列，求出其中任意一个数的左边离他最近的比他大的数字是哪个。单调栈、单调队列虽然看起来很难理解，但是题型只有那几个，非常局限，所以好掌握。

#### 左边最近的数问题
- 首先，虽然我们说是左边最近的数，但是如果要求右边最近也不是不行。只需要对称一下即可。
- 假设有这样的情况：`a[3]>a[5]`：
	- 如果要求`a[5]`左边离他最近的小于他的数，则`a[3]`被排除；
	- 现在我们要求`a[i]`左边离他最近的小于他的数（`i>=5`），那么如果`a[3]<a[i]`，则必然`a[5]<a[7]`，`a[3]`被排除；
- 也就是说`a[3]`必然不会属于答案。它不应该被暴力做法用到，或者说这种情况就是导致暴力做法“暴力”的原因。
!!! quote "结论" 
    于是可以得出结论：只要出现了逆序对，那么处在左边的那个元素就是被弃用的。于是，由于这些逆序对都被清除，整个序列就单调了，而且这个单调的序列中**必然包含该问题关于任意元素的答案**。

#### 单调序列思想
- 一言以蔽之曰，如果元素a比元素b小，且a还在b的右边，那么a就可以被删除，删除这些可以得到一个单调的序列。
- 于是，如果我们建立一个单调的栈，就满足了上述性质。因此单调栈可以用来解决该问题。

#### 复杂度
- 虽然看似是二重循环，但是实际上每个元素只最多会被入栈一次，出栈一次，所以实际上复杂度是$O(n)$.

