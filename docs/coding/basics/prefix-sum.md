# 前缀和

## 一维前缀和

#### 时间复杂度

预处理O(n)，询问O(1).

#### 思想

- 数组`a[i]`一定是下标从1开始。`a[0]`无意义。
- 前缀和`S[i]`的意思是从`a1`到`ai`的和。特别地，`S[0]=0`。
- 前缀和的作用是可以迅速求出其中一段数组的区间和，例如原数组中从`a[l]`加到`a[r]`的和，那么有`a[r]+...+a[l]=S[r]-S[l-1]`.注意是`l-1`。特别地，有`a[i]=S[i]-S[i-1]`，这就是后面要讨论的差分的原理。
- 为什么要定义`S[0]=0`？它明明没意义？原因是，这样可以统一求区间和的算法。例如你要求`a[1]+...+a[i]`，那么就可以仍然采用`S[i]-S[1-1]=S[i]-S[0]`，也就是`S[i]`了。

## 二维前缀和

#### 思想

- 求前缀和`S[i][j]`的方法：`S[i][j]=S[i][j-1]+S[i-1][j]-S[i-1][j-1]`，其中`S[i-1][j-1]`因为被加上了两遍所以减回去。
- 求区间和的方法：设一个坐标平面，左上角是原点，向右和向下的方向表示坐标数值递增，`S[a][b]`表示右下角坐标是`(a,b)`，左上角在原点的一个矩形，则如果要求左上角是`(k,l)`，右下角是`(i,j)`的矩形内的所有元素的和，就可以是`S'=S[i][j]-S[a][j]-S[i][b]+S[a][b]`，其中`S[a][b]`因为被减去了两遍所以加回来。
